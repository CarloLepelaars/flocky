# api


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

The Flock API reference can be found
[here](https://fed-ledger-prod.flock.io/docs#).

``` python
from dotenv import load_dotenv
load_dotenv()
```

    True

## Tasks

In most cases you will want to get single task information to work with.

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L19"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_task

>  get_task (task_id:int, as_df:bool=False)

*Get task as JSON or Dataframe.*

``` python
task_info = get_task(1, as_df=False)
task_info
```

    {'title': 'Foundation Model for Web3 Agent',
     'description': 'The Web3 world is buzzing about AI agents, but true decentralization can’t happen if every agent relies on GPT or Claude. FLock is rallying open-source and decentralized AI engineers to build a foundation model with robust function-calling capabilities for blockchain-related tasks. Together, let’s empower everyone to create their own models and agents.',
     'task_type': 'training',
     'data': {'training_set_url': 'https://fed-ledger-prod-dataset.s3.amazonaws.com/1/training_set.jsonl?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIASSFQ745NLT5K57N2%2F20250410%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20250410T130858Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=6565638731440c5bc264fff1c7b3598bbc88b984ce86c815799227f3bf296f3f',
      'max_params': 9500000000,
      'context_length': 4096},
     'duration_in_seconds': 2160000,
     'id': 1,
     'status': 'finalized',
     'initialized_at': '2024-12-31T03:02:33.260306',
     'submission_phase_ends_at': '2025-01-25T23:59:59.260306',
     'final_validation_ends_at': '2025-01-30T23:59:59.260306',
     'final_link': 'https://huggingface.co/jfranklin-foundry/task-1-microsoft-Phi-3-mini-4k-instruct'}

``` python
test_eq(task_info["id"], 1)
test_eq(task_info["task_type"], "training")
test_eq(task_info["title"], "Foundation Model for Web3 Agent")
```

``` python
task_df = get_task(1, as_df=True)
task_df
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">task_type</th>
<th data-quarto-table-cell-role="th">duration_in_seconds</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">initialized_at</th>
<th data-quarto-table-cell-role="th">submission_phase_ends_at</th>
<th data-quarto-table-cell-role="th">final_validation_ends_at</th>
<th data-quarto-table-cell-role="th">final_link</th>
<th data-quarto-table-cell-role="th">data_training_set_url</th>
<th data-quarto-table-cell-role="th">data_max_params</th>
<th data-quarto-table-cell-role="th">data_context_length</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>Foundation Model for Web3 Agent</td>
<td>The Web3 world is buzzing about AI agents, but...</td>
<td>training</td>
<td>2160000</td>
<td>1</td>
<td>finalized</td>
<td>2024-12-31T03:02:33.260306</td>
<td>2025-01-25T23:59:59.260306</td>
<td>2025-01-30T23:59:59.260306</td>
<td>https://huggingface.co/jfranklin-foundry/task-...</td>
<td>https://fed-ledger-prod-dataset.s3.amazonaws.c...</td>
<td>9500000000</td>
<td>4096</td>
</tr>
</tbody>
</table>

</div>

``` python
test_eq(task_df["id"].item(), task_info["id"])
test_eq(task_df["task_type"].item(), task_info["task_type"])
```

We are most interesting in tasks that are in the submission phase.

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L25"
target="_blank" style="float:right; font-size:smaller">source</a>

### open_tasks

>  open_tasks (as_df:bool=False)

``` python
open_task_df = open_tasks(as_df=True)
open_task_df
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">task_type</th>
<th data-quarto-table-cell-role="th">duration_in_seconds</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">initialized_at</th>
<th data-quarto-table-cell-role="th">submission_phase_ends_at</th>
<th data-quarto-table-cell-role="th">final_validation_ends_at</th>
<th data-quarto-table-cell-role="th">data_recommended_vram</th>
<th data-quarto-table-cell-role="th">data_dataset_s3_key</th>
<th data-quarto-table-cell-role="th">data_max_params</th>
<th data-quarto-table-cell-role="th">data_context_length</th>
<th data-quarto-table-cell-role="th">data_training_set_key</th>
<th data-quarto-table-cell-role="th">data_validation_set_key</th>
<th data-quarto-table-cell-role="th">data_final_validation_set_key</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>FLock x OneKey: Advancing AI-Driven Smart Cont...</td>
<td>FLock and OneKey are collaborating to launch t...</td>
<td>training</td>
<td>2419200</td>
<td>7</td>
<td>submission_phase</td>
<td>2025-03-26T16:22:01.791348</td>
<td>2025-04-23T23:59:59.791348</td>
<td>2025-04-28T23:59:59.791348</td>
<td>48GB</td>
<td>onekey-security/combined.jsonl</td>
<td>15000000000</td>
<td>8192</td>
<td>7/training_set.jsonl</td>
<td>7/validation_set.jsonl</td>
<td>7/final_validation_set.jsonl</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not open_task_df.empty
```

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L30"
target="_blank" style="float:right; font-size:smaller">source</a>

### finalized_tasks

>  finalized_tasks (as_df:bool=False)

``` python
fin_tasks = finalized_tasks(as_df=True)
fin_tasks.tail(3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">description</th>
<th data-quarto-table-cell-role="th">task_type</th>
<th data-quarto-table-cell-role="th">duration_in_seconds</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">initialized_at</th>
<th data-quarto-table-cell-role="th">submission_phase_ends_at</th>
<th data-quarto-table-cell-role="th">final_validation_ends_at</th>
<th data-quarto-table-cell-role="th">data_dataset_s3_key</th>
<th data-quarto-table-cell-role="th">data_max_params</th>
<th data-quarto-table-cell-role="th">data_context_length</th>
<th data-quarto-table-cell-role="th">data_training_set_key</th>
<th data-quarto-table-cell-role="th">data_validation_set_key</th>
<th data-quarto-table-cell-role="th">data_final_validation_set_key</th>
<th data-quarto-table-cell-role="th">data_recommended_vram</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">4</td>
<td>AI Hedge Fund: QuantumApex</td>
<td>QuantumApex will function as a key component o...</td>
<td>training</td>
<td>1296000</td>
<td>3</td>
<td>finalized</td>
<td>2025-01-30T15:46:35.932388</td>
<td>2025-02-14T23:59:59.932388</td>
<td>2025-02-19T23:59:59.932388</td>
<td>hedge_fund/combined.jsonl</td>
<td>8000000000</td>
<td>4096</td>
<td>3/training_set.jsonl</td>
<td>3/validation_set.jsonl</td>
<td>3/final_validation_set.jsonl</td>
<td>24GB</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">5</td>
<td>AI Producer: SEEK48</td>
<td>&lt;p&gt;FLock introduces SEEK48, an advanced AI ido...</td>
<td>training</td>
<td>2419200</td>
<td>6</td>
<td>finalized</td>
<td>2025-03-02T23:02:16.975240</td>
<td>2025-03-30T23:59:59.975240</td>
<td>2025-04-04T23:59:59.975240</td>
<td>ai-idol/combined.jsonl</td>
<td>8000000000</td>
<td>4096</td>
<td>6/training_set.jsonl</td>
<td>6/validation_set.jsonl</td>
<td>6/final_validation_set.jsonl</td>
<td>24GB</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">6</td>
<td>Chasm x FLock: AI Mystery</td>
<td>&lt;p&gt;FLock &amp; Chasm introduces an AI-powered meta...</td>
<td>training</td>
<td>2419200</td>
<td>5</td>
<td>finalized</td>
<td>2025-02-21T16:55:52.751560</td>
<td>2025-03-21T23:59:59.751560</td>
<td>2025-03-26T23:59:59.751560</td>
<td>ai-mystery/combined.jsonl</td>
<td>8000000000</td>
<td>2048</td>
<td>5/training_set.jsonl</td>
<td>5/validation_set.jsonl</td>
<td>5/final_validation_set.jsonl</td>
<td>24GB</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not fin_tasks.empty
```

## Submission Scores

To view submission scores you will need to set a valid `FLOCK_API_KEY`
in your environment. I suggest using
[python-dotenv](https://pypi.org/project/python-dotenv).

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L35"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_subs

>  get_subs (task_id:int, as_df:bool=False)

*Get submissions as JSON or Dataframe.*

``` python
sub_df = get_subs(7, as_df=True)
sub_df.T
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">link</td>
<td>https://huggingface.co/clepelaars/task-7-Qwen-...</td>
<td>https://huggingface.co/clepelaars/task-7-Qwen-...</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">submission_phase_score</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">final_validation_score</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">submitted_at</td>
<td>2025-04-10T13:05:58.502101</td>
<td>2025-03-28T12:45:21.402671</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not sub_df.empty
```

## Stats

The Flock API provides several global and wallet-based stats.

### Global stats

The most meaningful global stats are the submission and validation
counts per day.

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L48"
target="_blank" style="float:right; font-size:smaller">source</a>

### sub_stats

>  sub_stats (as_df:bool)

*Submissions and validation counts per day.*

Submission counts as a DataFrame

``` python
subs = sub_stats(as_df=True)
subs.tail(3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">100</td>
<td>2025-04-08</td>
<td>28</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">101</td>
<td>2025-04-09</td>
<td>39</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">102</td>
<td>2025-04-10</td>
<td>35</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not subs.empty
```

Validation counts as a DataFrame

``` python
def val_stats(as_df: bool):
    """ Validation counts per day. """
    j = urljson(f'{BASE_URL}stats/emissions?type=validation')['data']
    return pd_parse(j) if as_df else j
```

``` python
val = val_stats(as_df=True)
val.tail(3)
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">time</th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">100</td>
<td>2025-04-08</td>
<td>1874</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">101</td>
<td>2025-04-09</td>
<td>2521</td>
</tr>
<tr>
<td data-quarto-table-cell-role="th">102</td>
<td>2025-04-10</td>
<td>2306</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not val.empty
```

### Wallet-based stats

Most statistics are based on individual addresses. This includes: - Get
submissions for a particular wallet - Get achievements of a particular
wallet - Retrieve in which tasks a wallet is enrolled (i.e. staked).

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L54"
target="_blank" style="float:right; font-size:smaller">source</a>

### FlockWalletStats

>  FlockWalletStats (address:str)

*Get wallet-based stats.*

``` python
example_wallet = "0xB93A9c73751Bbca8E1924954271ee8d4De5747c9"
fwl = FlockWalletStats(example_wallet)
fwl
```

    FlockWalletStats(address='0xB93A9c73751Bbca8E1924954271ee8d4De5747c9', base_url='https://fed-ledger-prod.flock.io/api/v1/stats/')

``` python
test_eq(fwl.address, example_wallet)
```

We can now retrieve the valid submissions of the wallet as JSON or a
DataFrame.

``` python
fwl.subs(as_df=False)
```

    {'items': [], 'total': 0, 'page': 1, 'size': 50, 'pages': 0}

``` python
m = fwl.subs(as_df=True)
m
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">items</th>
<th data-quarto-table-cell-role="th">total</th>
<th data-quarto-table-cell-role="th">page</th>
<th data-quarto-table-cell-role="th">size</th>
<th data-quarto-table-cell-role="th">pages</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>[]</td>
<td>0</td>
<td>1</td>
<td>50</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not m.empty
```

Validation achievements

``` python
val_achievements = fwl.achievements(as_df=True, role='validator')
val_achievements
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gold_medals</th>
<th data-quarto-table-cell-role="th">silver_medals</th>
<th data-quarto-table-cell-role="th">bronze_medals</th>
<th data-quarto-table-cell-role="th">total_participations</th>
<th data-quarto-table-cell-role="th">tasks</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>[]</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not val_achievements.empty
expected_cols = ["gold_medals", "silver_medals", "bronze_medals", "total_participations", "tasks"]
test_eq(val_achievements.columns.tolist(), expected_cols)
```

Node achievements

``` python
node_achievements = fwl.achievements(as_df=True, role='node')
node_achievements
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&#10;    .dataframe tbody tr th {
        vertical-align: top;
    }
&#10;    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe" data-quarto-postprocess="true" data-border="1">
<thead>
<tr style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">gold_medals</th>
<th data-quarto-table-cell-role="th">silver_medals</th>
<th data-quarto-table-cell-role="th">bronze_medals</th>
<th data-quarto-table-cell-role="th">total_participations</th>
<th data-quarto-table-cell-role="th">tasks</th>
</tr>
</thead>
<tbody>
<tr>
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>[]</td>
</tr>
</tbody>
</table>

</div>

``` python
assert not node_achievements.empty
test_eq(node_achievements.columns.tolist(), expected_cols)
```

## HuggingFace

A general requirement for participating in Flock tasks is to upload
models to the HuggingFace Hub. For this you will need a [HuggingFace
token with write
access](https://huggingface.co/docs/hub/security-tokens) and set the
`HF_TOKEN` environment variable. For setting environment variables I
would recommend using
[python-dotenv](https://pypi.org/project/python-dotenv).

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L79"
target="_blank" style="float:right; font-size:smaller">source</a>

### upload_to_hf

>  upload_to_hf (repo_name:str, output_dir:str='outputs')

*Upload a model to the HuggingFace Hub. :param repo_name: the name of
the repository to upload to. For example: `myhfname/task-1-model`.
:param output_dir: the directory to upload to the HuggingFace Hub.
:return: the commit hash you will need to submit to Flock.*

## Submitting to Task

Once you have the HuggingFace model uploaded and retrieved the commit
hash, you can submit your results to the Flock task.

------------------------------------------------------------------------

<a
href="https://github.com/CarloLepelaars/flocky/blob/master/flocky/api.py#L100"
target="_blank" style="float:right; font-size:smaller">source</a>

### submit_task

>  submit_task (task_id:int, hg_repo_id:str, base_model:str,
>                   commit_hash:str)

*Submit results to Flock task. :param task_id: the ID of the task you
want to submit to. :param hg_repo_id: the ID of the HuggingFace
repository you want to submit. :param base_model: the base model you
want to use. Must be a valid model name like “Qwen/Qwen1.5-7B or
google/gemma-7b. :param commit_hash: the HuggingFace Hub Model commit
hash of the model you want to submit.*

------------------------------------------------------------------------
